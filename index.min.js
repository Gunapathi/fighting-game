const canvas=document.querySelector("canvas"),c=canvas.getContext("2d"),gravity=.7;canvas.width=1024,canvas.height=576;const background=new Sprites({position:{x:0,y:0},imageSrc:"./asset/background.png"}),shop=new Sprites({position:{x:650,y:128},imageSrc:"./asset/shop.png",scale:2.75,framesMax:6});c.fillRect(0,0,canvas.width,canvas.height);const player=new Fighter({position:{x:canvas.width/4,y:0},velocity:{x:0,y:0},offset:{x:0,y:0},imageSrc:"./asset/samuraiMack/Idle.png",scale:2.75,framesMax:8,offset:{x:215,y:187},Sprites:{idle:{imageSrc:"./asset/samuraiMack/Idle.png",framesMax:8},run:{imageSrc:"./asset/samuraiMack/Run.png",framesMax:8},jump:{imageSrc:"./asset/samuraiMack/Jump.png",framesMax:2},fall:{imageSrc:"./asset/samuraiMack/Fall.png",framesMax:2},attack1:{imageSrc:"./asset/samuraiMack/Attack1.png",framesMax:6},takeHit:{imageSrc:"./asset/samuraiMack/Take Hit - white silhouette.png",framesMax:4},death:{imageSrc:"./asset/samuraiMack/Death.png",framesMax:6}},attackBox:{offset:{x:130,y:50},width:170,height:50}}),enemy=new Fighter({position:{x:canvas.width/2,y:100},velocity:{x:0,y:0},color:"blue",offset:{x:-50,y:0},imageSrc:"./asset/kenji/Idle.png",scale:2.75,framesMax:4,offset:{x:215,y:200},Sprites:{idle:{imageSrc:"./asset/kenji/Idle.png",framesMax:4},run:{imageSrc:"./asset/kenji/Run.png",framesMax:8},jump:{imageSrc:"./asset/kenji/Jump.png",framesMax:2},fall:{imageSrc:"./asset/kenji/Fall.png",framesMax:2},attack1:{imageSrc:"./asset/kenji/Attack1.png",framesMax:4},takeHit:{imageSrc:"./asset/kenji/Take hit.png",framesMax:3},death:{imageSrc:"./asset/kenji/Death.png",framesMax:7}},attackBox:{offset:{x:-210,y:50},width:170,height:50}});enemy.draw();const keys={a:{pressed:!1},d:{pressed:!1},w:{pressed:!1},ArrowRight:{pressed:!1},ArrowLeft:{pressed:!1}};let lastKey;function animate(){window.requestAnimationFrame(animate),c.fillStyle="black",c.fillRect(0,0,canvas.width,canvas.height),background.update(),shop.update(),c.fillStyle="rgba(255,255,255,0.1)",c.fillRect(0,0,canvas.width,canvas.height),player.update(),enemy.update(),player.velocity.x=0,enemy.velocity.x=0,keys.a.pressed&&"a"===player.lastKey?(player.velocity.x=-5,player.switchSprite("run")):keys.d.pressed&&"d"===player.lastKey?(player.velocity.x=5,player.switchSprite("run")):player.switchSprite("idle"),player.velocity.y<0?player.switchSprite("jump"):player.velocity.y>0&&player.switchSprite("fall"),keys.ArrowLeft.pressed&&"ArrowLeft"===enemy.lastKey?(enemy.velocity.x=-5,enemy.switchSprite("run")):keys.ArrowRight.pressed&&"ArrowRight"===enemy.lastKey?(enemy.velocity.x=5,enemy.switchSprite("run")):enemy.switchSprite("idle"),player.velocity.y<0?enemy.switchSprite("jump"):enemy.velocity.y>0&&enemy.switchSprite("fall"),rectangularCollision({rectangle1:player,rectangle2:enemy})&&player.isAttacking&&4===player.frameCurrent&&(enemy.takeHit(),player.isAttacking=!1,gsap.to("#enemyHealth",{width:enemy.health+"%"}),console.log("player attack")),player.isAttacking&&4===player.frameCurrent&&(player.isAttacking=!1),rectangularCollision({rectangle1:enemy,rectangle2:player})&&enemy.isAttacking&&2===enemy.frameCurrent&&(player.takeHit(),enemy.isAttacking=!1,gsap.to("#playerHealth",{width:player.health+"%"}),console.log("enemy attack")),(enemy.health<=0||player.health<=0)&&determineWinner({player:player,enemy:enemy,timerId:timerId}),enemy.isAttacking&&2===enemy.frameCurrent&&(enemy.isAttacking=!1)}descreaseTimer(),animate(),window.addEventListener("keydown",event=>{if(!player.dead)switch(event.key){case"d":keys.d.pressed=!0,player.lastKey="d";break;case"a":keys.a.pressed=!0,player.lastKey="a";break;case"w":player.velocity.y=-20;break;case" ":player.attack()}if(!enemy.dead)switch(event.key){case"ArrowRight":keys.ArrowRight.pressed=!0,enemy.lastKey="ArrowRight";break;case"ArrowLeft":keys.ArrowLeft.pressed=!0,enemy.lastKey="ArrowLeft";break;case"ArrowUp":enemy.velocity.y=-20;break;case"ArrowDown":enemy.attack()}}),window.addEventListener("keyup",event=>{switch(event.key){case"d":keys.d.pressed=!1;break;case"a":keys.a.pressed=!1}switch(event.key){case"ArrowRight":keys.ArrowRight.pressed=!1;break;case"ArrowLeft":keys.ArrowLeft.pressed=!1}});